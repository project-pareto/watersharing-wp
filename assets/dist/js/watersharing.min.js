!function(t){function e(){t("table.tablesorter").each((function(){var e=t(this).attr("id");t("#"+e).tablesorter().bind("sortEnd",(function(a,n){t("#"+e+" .row-summary").each((function(){var a=t(this),n=a.data("row-number"),o=t("#"+e+" .row-expanded[data-row-number='"+n+"']");a.after(o)}))}))}))}t(".geoentry").on("input",(function(){var e=t(this).val();e=(e=e.replace(/[^0-9.-]/g,"")).replace(/^0+/,""),t(this).val(e)})),t(document).on("click","input.watersharing-input-row",(function(){!function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=document.querySelectorAll('input[type="checkbox"]'),a=document.getElementById(t+"-status-submit"),n=0;n<e.length;n++)if(e[n].checked)return void(a.disabled=!1);a.disabled=!0}(t(this).data("watershare-type"))})),t(document).on("click",".post-status-submit",(function(e){t(this);var a=t(this).prev("select").val();""===a||null===a?(e.preventDefault(),alert("Please select an action")):confirm("Are you sure you want to "+a+" your request(s)?")||e.preventDefault()})),t(document).on("input","#start_date",(function(){var e=t(this),a=t(this).parent().parent().find(".end-dp #end_date");t(a).val(""),t(a).attr("min",t(e).val()),t(a).prop("disabled",!1)})),t(document).on("blur","#end_date",(function(){t(this).val()<t(this).parent().parent().find(".start-dp #start_date").val()&&(alert("End date cannot be before the start date."),endDateInput.val(""))})),t(document).on("blur","input#longitude, input#latitude",(function(){var e=t(this).closest("form"),a=e.find("input#longitude"),n=e.find("input#latitude"),o=parseFloat(a.val()),i=parseFloat(n.val());isNaN(o)||isNaN(i)||(o<-124.785543||o>-66.945554||i<24.446667||i>49.382812)&&(alert("Coordinates must fall within continental USA"),a.val(""),n.val(""))})),t(document).on("click",".create-post-submit-button",(function(e){t(this).closest("form").find("[required]").filter((function(){return""===t(this).val().trim()})).length>0&&alert("Please fill in all required fields in the Primary Information section.")})),t(document).on("click",".toggle-row",(function(){if(t(this).closest("tr").next("tr").hasClass("show")){t(this).toggleClass("active"),t(this).closest("tr").next("tr").removeClass("show"),t(this).closest("tr").next("tr").addClass("collapsing");var e=t(this);setTimeout((function(e){t(e).closest("tr").next("tr").removeClass("collapsing"),t(e).closest("tr").next("tr").addClass("collapse")}),400,e)}else t(".toggle-row").each((function(){if(t(this).closest("tr").next("tr").hasClass("show")){t(this).toggleClass("active"),t(this).closest("tr").next("tr").removeClass("show"),t(this).closest("tr").next("tr").addClass("collapsing");var e=t(this);setTimeout((function(e){t(e).closest("tr").next("tr").removeClass("collapsing"),t(e).closest("tr").next("tr").addClass("collapse")}),400,e)}})),t(this).toggleClass("active"),t(this).closest("tr").next("tr").removeClass("collapse"),t(this).closest("tr").next("tr").addClass("collapsing"),e=t(this),setTimeout((function(e){t(e).closest("tr").next("tr").removeClass("collapsing"),t(e).closest("tr").next("tr").addClass("show")}),100,e)})),t(document).on("change",'select[name="well_pad"]',(function(){t(this).val();var e=t(this).find(":selected").data("lat"),a=t(this).find(":selected").data("long"),n=t(this).find(":selected").data("title");t("input#well_name").val(n),t("input#latitude").val(e),t("input#longitude").val(a),t("input#well_name").addClass("readonly"),t("input#latitude").addClass("readonly"),t("input#longitude").addClass("readonly")})),t(document).on("click","a.approval",(function(){var a="#"+t(this).data("table");a=t(a).parent();var n=[];n.lookupid=t(this).data("lookup"),n.matchid=t(this).data("match"),n.parentid=t(this).data("parent"),n.interaction=t(this).data("action"),n.interactiontype=t(this).data("match-type"),n.dataTable=a,n.rowOpen=t(this).parents().eq(7).data("row-number"),confirm("Are you sure you want to "+n.interaction+" this match?")&&function(a){var n=a.dataTable.find("table").attr("id").split("-")[0];t("."+n+"-loading-indicator").show(),t.ajax({url:"/wp-admin/admin-ajax.php",type:"POST",data:{action:"ajax_approval",lookup_record:a.lookupid,parent_record:a.parentid,match_record:a.matchid,action_status:a.interaction,action_type:a.interactiontype,nonce:window.my_ajax_object&&window.my_ajax_object.nonces?window.my_ajax_object.nonces.ajax_approval:""},dataType:"json",beforeSend:function(e){t(a.dataTable).html("")},success:function(n){t(a.dataTable).html(n),e()},complete:function(e){t("."+n+"-loading-indicator").hide()},error:function(e){t("."+n+"-loading-indicator").hide()}})}(n)})),t(document).ready((function(){e()})),t(document).ready((function(){function e(t,e){t.hasClass("collapsing")&&!t.hasClass("show-initial")||(t.css("height",t[0].scrollHeight+"px").removeClass("collapse show show-initial").addClass("collapsing"),t[0].offsetHeight,t.css("height",0).one("transitionend",(function(){t.removeClass("collapsing").addClass("collapse").css("height","")})),e.addClass("collapsed").attr("aria-expanded",!1))}function a(t){return t.replace(/\B(?=(\d{3})+(?!\d))/g,",")}var n,o;jQuery("[data-append-to]").each((function(){var t=jQuery(this),e=t.data("append-to"),a=jQuery(e);a.length&&(t.appendTo(a),t.removeAttr("data-append-to"),t.addClass("js-moved"))})),n=document.getElementById("send-to-dialog"),o=document.querySelectorAll(".send-to-btn"),n&&o.length&&(o.forEach((function(t){var e=t.getAttribute("data-pid"),a=t.getAttribute("data-table-type");t.addEventListener("click",(function(){!function(){var t=document.querySelector(".send-to-dialog");if(t){var e=t.querySelectorAll("input:disabled, select:disabled, textarea:disabled");e&&e.forEach((function(t){t.disabled=!1}))}}(),function(t,e){if(void 0!==window.sendToData&&window.sendToData[e]){var a=window.sendToData[e][t]||window.sendToData[e][String(t)]||window.sendToData[e][Number(t)];if(a){var n=document.querySelector(".send-to-dialog");n&&Object.keys(a).forEach((function(t){var e=a[t];if("pid"!==t){var o=n.querySelector('[name="'.concat(t,'"]'));o&&("checkbox"===o.type?o.checked="1"==e||!0===e||"true"===e:"radio"===o.type?n.querySelectorAll('[name="'.concat(t,'"]')).forEach((function(t){t.value===e&&(t.checked=!0)})):"select"===o.tagName.toLowerCase()?o.value=e:o.value=e||"")}}))}}}(e,a),function(){var t=document.querySelector("#send-to-dialog");if(t){var e=!1;["truck_transport_radius","truck_transport_bid","truck_capacity"].forEach((function(a){var n=t.querySelector("#".concat(a));n&&n.value&&""!==n.value.trim()&&"0"!==n.value&&(e=!0)}));var a=t.querySelector("#trucks-checkbox");a&&(a.checked=e);var n=!1;["layflats_transport_radius","layflats_transport_bid","layflats_capacity"].forEach((function(e){var a=t.querySelector("#".concat(e));a&&a.value&&""!==a.value.trim()&&"0"!==a.value&&(n=!0)}));var o=t.querySelector("#layflats-checkbox");o&&(o.checked=n)}}(),n.showModal()}))})),n.querySelectorAll(".dialog-closer").forEach((function(t){t.onclick=function(){n.close()}}))),t(".accordion-button").on("click",(function(){var a=t(this).attr("data-bs-target"),n=t(a),o=t(this);n.hasClass("show")||n.hasClass("show-initial")?e(n,o):(function(t,e){if(!t.hasClass("collapsing")&&!t.hasClass("show")&&!t.hasClass("show-initial")){t.removeClass("collapse").addClass("collapsing").css("height",0),t[0].offsetHeight;var a=t[0].scrollHeight;t.css("height",a+"px").one("transitionend",(function(){t.removeClass("collapsing").addClass("collapse show").css("height","")})),e.removeClass("collapsed").attr("aria-expanded",!0)}}(n,o),function(a){t(".accordion-collapse").not(a).each((function(){var a=t(this),n=t('[data-bs-target="#'+a.attr("id")+'"]');a&&n&&e(a,n)}))}(n))})),t(".checkbox").change((function(){var e=t(this).is(":checked");t(this).closest(".watersharing-row").find('input[type="number"]').prop("disabled",!e)})),t(".checkbox").each((function(){var e=t(this).attr("class").split(" ").find((function(t){return t.includes("trade_supply")||t.includes("trade_demand")}));e&&t(this).closest(".watersharing-row").find('input[type="number"][class*="'.concat(e.split("-")[0],'"]')).prop("disabled",!0)})),t(document).on("change","input[name=rate_bpd],input[name=bid_amount],select[name=bid_units]",(function(){var e=t(this).closest("form, .send-to-dialog, .watersharing-form"),n=e.find('[name="bid_total"]'),o=e.find('[name="bid_amount"]'),i=e.find('[name="rate_bpd"]'),s=e.find('[name="bid_units"]'),l=e.find('[name="bid_specific_total"]'),r=parseFloat(o.val()),c=parseFloat(i.val()),d=s.val();isNaN(r)||isNaN(c)||null==d?(n.val(""),l.val("")):"USD/bbl.day"==d?(n.val(a((r*c).toFixed(2))),l.val(a(r.toFixed(2)))):(n.val(a(r.toFixed(2))),l.val(a((r/c).toFixed(2))))}))})),document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".chart-container").forEach((function(t){var e=t.getAttribute("data-block-id"),a=JSON.parse(t.getAttribute("data-chart-data")),n=document.getElementById("stat-chart-".concat(e));if(n&&a){var o=n.getContext("2d"),i=a.map((function(t){return t.volume})),s=a.map((function(t){return t.date}));new Chart(o,{type:"line",data:{labels:s,datasets:[{label:"Ongoing trades",data:i,borderWidth:1}]},options:{scales:{y:{beginAtZero:!0,title:{display:!0,text:"Volume(bbl)"}}},plugins:{legend:{display:!1},title:{display:!0,text:"Ongoing Trades",font:{size:20,weight:"bold"}},tooltip:{enabled:!1}},responsive:!0,maintainAspectRatio:!1}})}})),t(document).on("click",".download-summary-btn",(function(e){e.preventDefault();var a=t(this).data("tradeCsv");t.ajax({url:my_ajax_object.ajax_url,method:"POST",data:{action:"download_latest_summary",trade_csv:a,nonce:window.my_ajax_object&&window.my_ajax_object.nonces?window.my_ajax_object.nonces.download_latest_summary:""},xhrFields:{responseType:"blob"},success:function(t){if(t instanceof Blob&&t.size){var e=window.URL.createObjectURL(t),n=document.createElement("a");n.style.display="none",n.href=e,n.download=a+" Summary.csv",document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(e)}else console.error("Invalid or empty Blob response:",t),alert("The file could not be downloaded.")},error:function(t,e,a){console.error("AJAX error:",e,a),alert("Could not download the file. May be missing or empty, please try again.")}})})),jQuery})),window.downloadCsv=function(t,e){var a=new FormData;a.append("action","download_csv"),a.append("csv_data",JSON.stringify(e)),a.append("nonce",window.my_ajax_object&&window.my_ajax_object.nonces?window.my_ajax_object.nonces.download_csv:""),fetch(t,{method:"POST",body:a}).then((function(t){if(t.ok)return t.blob();throw new Error("Network response was not ok.")})).then((function(t){var e=window.URL.createObjectURL(t),a=document.createElement("a");a.style.display="none",a.href=e,a.download="trades_data.csv",document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(e)})).catch((function(t){return console.error("There was an error with the download:",t)}))}}(jQuery);